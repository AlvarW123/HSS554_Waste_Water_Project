import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

dfs = []

# get encoding for dataframe
with open('data/added_error/uster_1.csv') as f:
    encoding = f.encoding

# load dataframes
for i in range(1,7):
    dfs.append(pd.read_csv("data/modified_uster/uster_"+str(i)+".csv", encoding = encoding))

# test_df = dfs.pop()
# train_df = pd.concat(dfs)
df = pd.concat(dfs)

df.drop(["Unnamed: 0"], axis = 1,inplace = True)

df["Month"] = pd.to_datetime(df["Time [-]"],dayfirst=True).apply(lambda x: x.month)
df["Day"] = pd.to_datetime(df["Time [-]"],dayfirst=True).apply(lambda x: x.day)
df["Hour"] = pd.to_datetime(df["Time [-]"],dayfirst=True).apply(lambda x: x.hour)

print(df["Month"])

df.drop(["Time [-]"], axis = 1,inplace = True)

from scipy.stats import f_oneway

# Creating a sample dataset (replace this with your data)
df_month = df[["Month","N2O [kgN/h]"]]

# Creating a pandas DataFrame

# Performing ANOVA
result = f_oneway(*[df_month['N2O [kgN/h]'][df_month['Month'] == category] for category in df_month['Month'].unique()])

# Output results
print(f"F-statistic: {result.statistic}")
print(f"P-value: {result.pvalue}")

df_day = df[["Day","N2O [kgN/h]"]]

# Creating a pandas DataFrame

# Performing ANOVA
result = f_oneway(*[df_day['N2O [kgN/h]'][df_day['Day'] == category] for category in df_day['Day'].unique()])

# Output results
print(f"F-statistic: {result.statistic}")
print(f"P-value: {result.pvalue}")


df_hour = df[["Hour","N2O [kgN/h]"]]

# Creating a pandas DataFrame

# Performing ANOVA
result = f_oneway(*[df_hour['N2O [kgN/h]'][df_hour['Hour'] == category] for category in df_hour['Hour'].unique()])

# Output results
print(f"F-statistic: {result.statistic}")
print(f"P-value: {result.pvalue}")